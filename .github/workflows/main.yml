name: IQYWWNBDKOTK

on:
  workflow_dispatch:

jobs:
  clone-compile-run:
    runs-on: ubuntu-latest

    steps:
    - name: üóëÔ∏è Limpiar directorio anterior
      run: |
        echo "Limpiando directorios anteriores..."
        rm -rf BotUDPs 2>/dev/null || true

    - name: üì• Clonar repositorio CON VERIFICACI√ìN
      run: |
        echo "Iniciando clonado del repositorio..."
        
        # Intento principal de clonado con m√°s informaci√≥n
        if git clone --verbose https://github.com/zJonch14/BotUDPs.git 2>&1; then
          echo "‚úÖ Repositorio clonado exitosamente en BotUDPs/"
        else
          echo "‚ùå Error en el clonado inicial. Probando clonado superficial (shallow clone)..."
          # Intento alternativo: clonado superficial (solo la √∫ltima confirmaci√≥n)
          if git clone --depth=1 https://github.com/zJonch14/BotUDPs.git 2>&1; then
            echo "‚úÖ Repositorio clonado (shallow) exitosamente."
          else
            echo "‚ùå‚ùå Error cr√≠tico: No se pudo clonar el repositorio."
            echo "Verifica:"
            echo "1. Que la URL 'https://github.com/zJonch14/BotUDPs.git' sea correcta."
            echo "2. Que el repositorio exista y sea p√∫blico."
            echo "3. Tu conexi√≥n a internet."
            exit 1 # Falla el job aqu√≠ si el clonado no funciona
          fi
        fi

    - name: üìã VERIFICAR que el clonado funcion√≥
      run: |
        echo "Verificando contenido del directorio clonado..."
        if [ -d "BotUDPs" ]; then
          cd BotUDPs
          echo "‚úÖ Directorio 'BotUDPs' encontrado."
          echo "Contenido inicial:"
          ls -la
          # Comprobaci√≥n cr√≠tica: el archivo bot.py debe existir
          if [ -f "bot.py" ]; then
            echo "‚úÖ Archivo cr√≠tico 'bot.py' encontrado."
          else
            echo "‚ùå ERROR: El archivo 'bot.py' NO est√° en el repositorio clonado."
            echo "El repositorio podr√≠a estar vac√≠o o tener una estructura diferente."
            exit 1
          fi
          cd ..
        else
          echo "‚ùå ERROR CR√çTICO: El directorio 'BotUDPs' no se cre√≥. El clonado fall√≥."
          exit 1
        fi

    - name: üêç Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: üì¶ Instalar dependencias
      run: |
        echo "Instalando dependencias..."
        cd BotUDPs
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        cd ..

    - name: üî® Compilar (si es necesario)
      run: |
        echo "Compilando archivos..."
        cd BotUDPs
        # Aqu√≠ ir√≠an los comandos de compilaci√≥n espec√≠ficos de tu proyecto.
        # Este es un ejemplo, aj√∫stalo seg√∫n tu necesidad.
        # Si tu proyecto no necesita compilaci√≥n, puedes eliminar este paso.
        # Ejemplo para compilar un archivo .py a .pyc
        # python -m compileall .
        echo "No se requieren comandos de compilaci√≥n espec√≠ficos."
        cd ..

    - name: ‚ñ∂Ô∏è Ejecutar Bot UDP
      run: |
        echo "Ejecutando Bot UDP..."
        cd BotUDPs
        python bot.py
        cd ..

